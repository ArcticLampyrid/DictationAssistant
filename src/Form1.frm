VERSION 5.00
Object = "{F9043C88-F6F2-101A-A3C9-08002B2F49FB}#1.2#0"; "comdlg32.ocx"
Object = "{831FDD16-0C5C-11D2-A9FC-0000F8754DA1}#2.1#0"; "mscomctl.ocx"
Begin VB.Form Form1 
   AutoRedraw      =   -1  'True
   Caption         =   "×Ô¶¯Ä¬Ð´"
   ClientHeight    =   8610
   ClientLeft      =   225
   ClientTop       =   555
   ClientWidth     =   12810
   BeginProperty Font 
      Name            =   "Î¢ÈíÑÅºÚ"
      Size            =   36
      Charset         =   134
      Weight          =   400
      Underline       =   0   'False
      Italic          =   0   'False
      Strikethrough   =   0   'False
   EndProperty
   Icon            =   "Form1.frx":0000
   LinkTopic       =   "Form1"
   ScaleHeight     =   8610
   ScaleWidth      =   12810
   StartUpPosition =   2  'ÆÁÄ»ÖÐÐÄ
   Begin VB.Frame Frame3 
      Caption         =   "ÒýÇæÉèÖÃ"
      BeginProperty Font 
         Name            =   "ËÎÌå"
         Size            =   9
         Charset         =   134
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   1935
      Left            =   7560
      TabIndex        =   22
      Top             =   6000
      Width           =   5055
      Begin VB.CommandButton Command11 
         Caption         =   "ÇÐ»»µ½Ó¢ÎÄÔÄ¶ÁÒýÇæ"
         BeginProperty Font 
            Name            =   "Î¢ÈíÑÅºÚ"
            Size            =   9
            Charset         =   134
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Left            =   2520
         TabIndex        =   31
         Top             =   1440
         Width           =   2415
      End
      Begin VB.CommandButton Command10 
         Caption         =   "ÇÐ»»µ½ÖÐÎÄÔÄ¶ÁÒýÇæ"
         BeginProperty Font 
            Name            =   "Î¢ÈíÑÅºÚ"
            Size            =   9
            Charset         =   134
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Left            =   120
         TabIndex        =   30
         Top             =   1440
         Width           =   2415
      End
      Begin VB.ComboBox Combo1 
         BeginProperty Font 
            Name            =   "Î¢ÈíÑÅºÚ"
            Size            =   9
            Charset         =   134
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Left            =   720
         Style           =   2  'Dropdown List
         TabIndex        =   28
         Top             =   960
         Width           =   4215
      End
      Begin MSComctlLib.Slider Slider2 
         Height          =   255
         Left            =   720
         TabIndex        =   24
         Top             =   240
         Width           =   4215
         _ExtentX        =   7435
         _ExtentY        =   450
         _Version        =   393216
         LargeChange     =   10
         SmallChange     =   5
         Max             =   100
         SelStart        =   100
         TickFrequency   =   5
         Value           =   100
      End
      Begin MSComctlLib.Slider Slider1 
         Height          =   255
         Left            =   720
         TabIndex        =   26
         Top             =   600
         Width           =   4215
         _ExtentX        =   7435
         _ExtentY        =   450
         _Version        =   393216
         LargeChange     =   3
         Min             =   -10
      End
      Begin VB.Label Label8 
         AutoSize        =   -1  'True
         Caption         =   "ÒýÇæ£º"
         BeginProperty Font 
            Name            =   "Î¢ÈíÑÅºÚ"
            Size            =   9
            Charset         =   134
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Left            =   120
         TabIndex        =   27
         Top             =   1020
         Width           =   540
      End
      Begin VB.Label Label9 
         AutoSize        =   -1  'True
         Caption         =   "ÓïËÙ£º"
         BeginProperty Font 
            Name            =   "Î¢ÈíÑÅºÚ"
            Size            =   9
            Charset         =   134
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Left            =   120
         TabIndex        =   25
         Top             =   600
         Width           =   540
      End
      Begin VB.Label Label11 
         AutoSize        =   -1  'True
         Caption         =   "ÒôÁ¿£º"
         BeginProperty Font 
            Name            =   "Î¢ÈíÑÅºÚ"
            Size            =   9
            Charset         =   134
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Left            =   120
         TabIndex        =   23
         Top             =   240
         Width           =   540
      End
   End
   Begin VB.Frame Frame2 
      Caption         =   "´ÊÓï²¥±¨"
      BeginProperty Font 
         Name            =   "ËÎÌå"
         Size            =   9
         Charset         =   134
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   5775
      Left            =   7560
      TabIndex        =   5
      Top             =   120
      Width           =   5055
      Begin VB.CommandButton Command3 
         Caption         =   "ÔÙ±¨Ò»±é(&A)"
         BeginProperty Font 
            Name            =   "Î¢ÈíÑÅºÚ"
            Size            =   9
            Charset         =   134
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Left            =   2460
         TabIndex        =   18
         Top             =   4680
         Width           =   2355
      End
      Begin VB.CommandButton Command9 
         Caption         =   "±¨ÉÏÒ»¸ö(&L)"
         BeginProperty Font 
            Name            =   "Î¢ÈíÑÅºÚ"
            Size            =   9
            Charset         =   134
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Left            =   120
         TabIndex        =   16
         Top             =   4680
         Width           =   2355
      End
      Begin VB.CommandButton Command5 
         Caption         =   "´ÓÍ·¿ªÊ¼(&H)"
         BeginProperty Font 
            Name            =   "Î¢ÈíÑÅºÚ"
            Size            =   9
            Charset         =   134
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Left            =   2460
         TabIndex        =   17
         Top             =   4320
         Width           =   2355
      End
      Begin VB.CommandButton Command1 
         Caption         =   "±¨ÏÂÒ»¸ö(&N)"
         BeginProperty Font 
            Name            =   "Î¢ÈíÑÅºÚ"
            Size            =   9
            Charset         =   134
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Left            =   120
         TabIndex        =   15
         Top             =   4320
         Width           =   2355
      End
      Begin VB.CommandButton Command7 
         Caption         =   "ÔÝÍ£×Ô¶¯²¥±¨(&P)"
         Enabled         =   0   'False
         BeginProperty Font 
            Name            =   "Î¢ÈíÑÅºÚ"
            Size            =   15.75
            Charset         =   134
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   735
         Left            =   120
         TabIndex        =   13
         Top             =   3600
         Width           =   4695
      End
      Begin VB.CommandButton Command12 
         Caption         =   "Í£Ö¹×Ô¶¯²¥±¨(&E)"
         Enabled         =   0   'False
         BeginProperty Font 
            Name            =   "Î¢ÈíÑÅºÚ"
            Size            =   9
            Charset         =   134
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Left            =   2460
         TabIndex        =   43
         Top             =   3240
         Width           =   2355
      End
      Begin VB.CommandButton Command6 
         Caption         =   "¿ªÊ¼×Ô¶¯²¥±¨(&S)"
         BeginProperty Font 
            Name            =   "Î¢ÈíÑÅºÚ"
            Size            =   9
            Charset         =   134
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Left            =   120
         TabIndex        =   12
         Top             =   3240
         Width           =   2355
      End
      Begin VB.TextBox Text1 
         BeginProperty Font 
            Name            =   "Î¢ÈíÑÅºÚ"
            Size            =   9
            Charset         =   134
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   390
         Left            =   3240
         MaxLength       =   4
         TabIndex        =   9
         Text            =   "3"
         Top             =   960
         Width           =   1575
      End
      Begin VB.TextBox Text2 
         BeginProperty Font 
            Name            =   "Î¢ÈíÑÅºÚ"
            Size            =   9
            Charset         =   134
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   405
         Left            =   3240
         MaxLength       =   4
         TabIndex        =   11
         Text            =   "2"
         Top             =   1560
         Width           =   1575
      End
      Begin VB.Label Label15 
         Alignment       =   2  'Center
         Caption         =   "0"
         BeginProperty Font 
            Name            =   "Î¢ÈíÑÅºÚ"
            Size            =   21.75
            Charset         =   134
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   570
         Left            =   2280
         TabIndex        =   42
         Top             =   1920
         Width           =   2055
      End
      Begin VB.Label Label14 
         Caption         =   "¸ö"
         BeginProperty Font 
            Name            =   "Î¢ÈíÑÅºÚ"
            Size            =   21.75
            Charset         =   134
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   570
         Left            =   4320
         TabIndex        =   41
         Top             =   1920
         Width           =   435
      End
      Begin VB.Label Label13 
         Caption         =   "ÕýÔÚ²¥±¨µÚ"
         BeginProperty Font 
            Name            =   "Î¢ÈíÑÅºÚ"
            Size            =   21.75
            Charset         =   134
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   570
         Left            =   120
         TabIndex        =   40
         Top             =   1920
         Width           =   2175
      End
      Begin VB.Label Label12 
         Caption         =   "ÔÝÍ£×Ô¶¯²¥±¨ºó°´¡°±¨ÏÂÒ»¸ö¡±¡¢¡°±¨ÉÏÒ»¸ö¡±»ò¡°ÔÙ±¨Ò»±é¡±ºó»á×Ô¶¯¿ªÊ¼×Ô¶¯²¥±¨¡£"
         BeginProperty Font 
            Name            =   "Î¢ÈíÑÅºÚ"
            Size            =   10.5
            Charset         =   134
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   615
         Left            =   120
         TabIndex        =   14
         Top             =   2520
         Width           =   4695
      End
      Begin VB.Label Label3 
         Caption         =   "½«ÓÚ"
         BeginProperty Font 
            Name            =   "Î¢ÈíÑÅºÚ"
            Size            =   21.75
            Charset         =   134
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   495
         Left            =   120
         TabIndex        =   19
         Top             =   5160
         Width           =   975
      End
      Begin VB.Label Label4 
         Caption         =   "Ãëºó×Ô¶¯²¥±¨"
         BeginProperty Font 
            Name            =   "Î¢ÈíÑÅºÚ"
            Size            =   21.75
            Charset         =   134
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   495
         Left            =   2205
         TabIndex        =   21
         Top             =   5160
         Width           =   2655
      End
      Begin VB.Label Label5 
         Alignment       =   2  'Center
         Caption         =   "0"
         BeginProperty Font 
            Name            =   "Î¢ÈíÑÅºÚ"
            Size            =   21.75
            Charset         =   134
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   495
         Left            =   1095
         TabIndex        =   20
         Top             =   5160
         Width           =   1095
      End
      Begin VB.Label Label1 
         Caption         =   "±¾´ÊÓï²¥±¨´ÎÊý"
         BeginProperty Font 
            Name            =   "Î¢ÈíÑÅºÚ"
            Size            =   21.75
            Charset         =   134
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   570
         Left            =   120
         TabIndex        =   6
         Top             =   240
         Width           =   3045
      End
      Begin VB.Label Label2 
         Alignment       =   2  'Center
         Caption         =   "0"
         BeginProperty Font 
            Name            =   "Î¢ÈíÑÅºÚ"
            Size            =   21.75
            Charset         =   134
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   570
         Left            =   3240
         TabIndex        =   7
         Top             =   240
         Width           =   1575
      End
      Begin VB.Label Label6 
         Caption         =   "×Ô¶¯²¥±¨¼ä¸ô£¨Ãë£©"
         BeginProperty Font 
            Name            =   "Î¢ÈíÑÅºÚ"
            Size            =   9
            Charset         =   134
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   300
         Left            =   120
         TabIndex        =   8
         Top             =   960
         Width           =   1620
      End
      Begin VB.Label Label7 
         Caption         =   "×Ô¶¯²¥±¨´ÎÊý£¨Ã¿¸ö´ÊÓï£©"
         BeginProperty Font 
            Name            =   "Î¢ÈíÑÅºÚ"
            Size            =   9
            Charset         =   134
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   300
         Left            =   120
         TabIndex        =   10
         Top             =   1560
         Width           =   2160
      End
   End
   Begin VB.Timer Timer1 
      Enabled         =   0   'False
      Interval        =   1000
      Left            =   11880
      Top             =   0
   End
   Begin VB.CommandButton Command2 
      BeginProperty Font 
         Name            =   "ËÎÌå"
         Size            =   9
         Charset         =   134
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   8415
      Left            =   7080
      MaskColor       =   &H00FFFFFF&
      Picture         =   "Form1.frx":324A
      Style           =   1  'Graphical
      TabIndex        =   4
      Top             =   120
      UseMaskColor    =   -1  'True
      Width           =   375
   End
   Begin VB.Frame Frame1 
      Caption         =   "´ÊÓïÁÐ±í"
      BeginProperty Font 
         Name            =   "ËÎÌå"
         Size            =   9
         Charset         =   134
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   8415
      Left            =   120
      TabIndex        =   0
      Top             =   120
      Width           =   6855
      Begin VB.CommandButton cmdSave 
         BeginProperty Font 
            Name            =   "ËÎÌå"
            Size            =   9
            Charset         =   134
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   330
         Left            =   6375
         Picture         =   "Form1.frx":4348
         Style           =   1  'Graphical
         TabIndex        =   39
         ToolTipText     =   "½«ÁÐ±íÏî±£´æµ½Ò»¸öTXTÎÄ¼þÖÐ£¨Ã¿¸ö´ÊÓï×÷ÎªÒ»ÐÐ£©"
         Top             =   720
         UseMaskColor    =   -1  'True
         Width           =   330
      End
      Begin VB.CommandButton cmdAdd 
         BeginProperty Font 
            Name            =   "ËÎÌå"
            Size            =   9
            Charset         =   134
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   330
         Left            =   6375
         Picture         =   "Form1.frx":444A
         Style           =   1  'Graphical
         TabIndex        =   38
         ToolTipText     =   "Ìí¼ÓÁÐ±íÏî"
         Top             =   2160
         UseMaskColor    =   -1  'True
         Width           =   330
      End
      Begin VB.CommandButton cmdDelete 
         Enabled         =   0   'False
         BeginProperty Font 
            Name            =   "ËÎÌå"
            Size            =   9
            Charset         =   134
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   330
         Left            =   6375
         Picture         =   "Form1.frx":454C
         Style           =   1  'Graphical
         TabIndex        =   37
         ToolTipText     =   "É¾³ýÑ¡¶¨ÁÐ±íÏî"
         Top             =   3120
         UseMaskColor    =   -1  'True
         Width           =   330
      End
      Begin VB.CommandButton cmdUp 
         Enabled         =   0   'False
         BeginProperty Font 
            Name            =   "ËÎÌå"
            Size            =   9
            Charset         =   134
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   330
         Left            =   6375
         Picture         =   "Form1.frx":464E
         Style           =   1  'Graphical
         TabIndex        =   36
         ToolTipText     =   "ÏòÉÏÒÆ¶¯"
         Top             =   1200
         UseMaskColor    =   -1  'True
         Width           =   330
      End
      Begin VB.CommandButton cmdDown 
         Enabled         =   0   'False
         BeginProperty Font 
            Name            =   "ËÎÌå"
            Size            =   9
            Charset         =   134
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   330
         Left            =   6375
         Picture         =   "Form1.frx":4750
         Style           =   1  'Graphical
         TabIndex        =   35
         ToolTipText     =   "ÏòÏÂÒÆ¶¯"
         Top             =   1680
         UseMaskColor    =   -1  'True
         Width           =   330
      End
      Begin VB.CommandButton cmdClear 
         Enabled         =   0   'False
         BeginProperty Font 
            Name            =   "ËÎÌå"
            Size            =   9
            Charset         =   134
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   330
         Left            =   6375
         MaskColor       =   &H00FFFFFF&
         Picture         =   "Form1.frx":4A92
         Style           =   1  'Graphical
         TabIndex        =   34
         ToolTipText     =   "Çå¿ÕÁÐ±í"
         Top             =   3600
         UseMaskColor    =   -1  'True
         Width           =   330
      End
      Begin VB.CommandButton cmdOpen 
         BeginProperty Font 
            Name            =   "ËÎÌå"
            Size            =   9
            Charset         =   134
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   330
         Left            =   6375
         Picture         =   "Form1.frx":4C34
         Style           =   1  'Graphical
         TabIndex        =   33
         ToolTipText     =   "´ÓÒ»¸öTXTÎÄ¼þÖÐÌí¼ÓÁÐ±íÏî£¨Ã¿ÐÐ×÷ÎªÒ»¸ö´ÊÓï£©"
         Top             =   240
         UseMaskColor    =   -1  'True
         Width           =   330
      End
      Begin VB.CommandButton Command4 
         Enabled         =   0   'False
         BeginProperty Font 
            Name            =   "ËÎÌå"
            Size            =   9
            Charset         =   134
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   330
         Left            =   6375
         MaskColor       =   &H00FFFFFF&
         Picture         =   "Form1.frx":4D36
         Style           =   1  'Graphical
         TabIndex        =   32
         ToolTipText     =   "ÐÞ¸ÄÑ¡ÖÐÁÐ±íÏî"
         Top             =   2640
         UseMaskColor    =   -1  'True
         Width           =   330
      End
      Begin VB.CommandButton cmdShowCount 
         Caption         =   "¼Æ"
         BeginProperty Font 
            Name            =   "Î¢ÈíÑÅºÚ"
            Size            =   9
            Charset         =   134
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   330
         Left            =   6375
         TabIndex        =   2
         ToolTipText     =   "¼ÆËã´ÊÓï×ÜÊý"
         Top             =   4080
         Width           =   330
      End
      Begin VB.CommandButton Command8 
         Caption         =   "Ñ¡"
         Enabled         =   0   'False
         BeginProperty Font 
            Name            =   "Î¢ÈíÑÅºÚ"
            Size            =   9
            Charset         =   134
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   330
         Left            =   6375
         TabIndex        =   3
         ToolTipText     =   "¿ìËÙÑ¡´Ê"
         Top             =   4560
         Width           =   330
      End
      Begin VB.ListBox List1 
         BeginProperty Font 
            Name            =   "Î¢ÈíÑÅºÚ"
            Size            =   21.75
            Charset         =   134
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   8040
         ItemData        =   "Form1.frx":4E68
         Left            =   120
         List            =   "Form1.frx":4E6A
         TabIndex        =   1
         Top             =   240
         Width           =   6255
      End
   End
   Begin MSComDlg.CommonDialog CommonDialog1 
      Left            =   11280
      Top             =   0
      _ExtentX        =   847
      _ExtentY        =   847
      _Version        =   393216
      Filter          =   "ÎÄ±¾ÎÄµµ(*.txt)|*.txt"
      MaxFileSize     =   32767
   End
   Begin VB.Label Label16 
      Alignment       =   2  'Center
      AutoSize        =   -1  'True
      Caption         =   "´ÊÓïÁÐ±í"
      BeginProperty Font 
         Name            =   "Î¢ÈíÑÅºÚ"
         Size            =   27.75
         Charset         =   134
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   750
      Left            =   2295
      TabIndex        =   44
      Top             =   3240
      Visible         =   0   'False
      Width           =   2235
   End
   Begin VB.Label Label10 
      Caption         =   "Ëæ»úÅÅÐò£ºÏÈ¼ÆËã´ÊÓïÊýÁ¿£¬ÔÚÊ¹ÓÃ¿ìËÙÑ¡´ÊÖÐµÄËæ»úÑ¡´Ê£¬½«Ëæ»úÑ¡´ÊÊýÁ¿ÌîÐ´Îª´ÊÓïÊýÁ¿¼´¿É¡£"
      BeginProperty Font 
         Name            =   "Î¢ÈíÑÅºÚ"
         Size            =   9
         Charset         =   134
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   465
      Left            =   7560
      TabIndex        =   29
      Top             =   8040
      Width           =   5040
   End
   Begin VB.Menu mnuFile 
      Caption         =   "ÎÄ¼þ(&F)"
      Begin VB.Menu mnuOpen 
         Caption         =   "´ÓTXTÎÄ¼þÖÐÌí¼Ó´ÊÓï(&O)..."
         Shortcut        =   ^O
      End
      Begin VB.Menu mnuSave 
         Caption         =   "½«´ÊÓï±£´æµ½TXTÎÄ¼þÖÐ(&S)..."
         Shortcut        =   ^S
      End
      Begin VB.Menu mnuFileSep 
         Caption         =   "-"
      End
      Begin VB.Menu mnuExit 
         Caption         =   "ÍË³ö(&E)"
      End
   End
   Begin VB.Menu mnuEdit 
      Caption         =   "±à¼­(&E)"
      Begin VB.Menu mnuShowWordControl 
         Caption         =   "ÏÔÊ¾/Òþ²Ø´ÊÓï¿ØÖÆÇø"
      End
      Begin VB.Menu mnuEditSep1 
         Caption         =   "-"
      End
      Begin VB.Menu mnuAdd 
         Caption         =   "Ìí¼Ó´ÊÓï..."
      End
      Begin VB.Menu mnuDelete 
         Caption         =   "É¾³ýÑ¡ÖÐ´ÊÓï..."
         Shortcut        =   {DEL}
      End
      Begin VB.Menu mnuClear 
         Caption         =   "Çå¿Õ´ÊÓïÁÐ±í"
      End
      Begin VB.Menu mnuModify 
         Caption         =   "ÐÞ¸ÄÑ¡ÖÐ´ÊÓï..."
      End
      Begin VB.Menu mnuEditSep2 
         Caption         =   "-"
      End
      Begin VB.Menu mnuUp 
         Caption         =   "ÏòÉÏÒÆ¶¯"
      End
      Begin VB.Menu mnuDown 
         Caption         =   "ÏòÏÂÒÆ¶¯"
      End
      Begin VB.Menu mnuEditSep3 
         Caption         =   "-"
      End
      Begin VB.Menu mnuSelected 
         Caption         =   "¿ìËÙÑ¡´Ê..."
      End
   End
   Begin VB.Menu Menu1 
      Caption         =   "ÒýÇæ(&T)"
      Begin VB.Menu Menu2 
         Caption         =   "ÉèÖÃµ¥´ÊÔöÇ¿Ä¿Â¼..."
      End
   End
   Begin VB.Menu mnuHelp 
      Caption         =   "°ïÖú(&H)"
      Begin VB.Menu mnuAbout 
         Caption         =   "¹ØÓÚ(&A)..."
      End
   End
   Begin VB.Menu mnuListPopup 
      Caption         =   "ÁÐ±íµ¯³ö²Ëµ¥"
      Visible         =   0   'False
      Begin VB.Menu mnuName_ListPopup 
         Caption         =   "µ±Ç°Ñ¡Ôñ£º*£¨µÚ#Ìõ£©"
         Enabled         =   0   'False
      End
      Begin VB.Menu mnuListPopupSep1 
         Caption         =   "-"
      End
      Begin VB.Menu mnuUp_ListPopup 
         Caption         =   "ÉÏÒÆ"
      End
      Begin VB.Menu mnuDown_ListPopup 
         Caption         =   "ÏÂÒÆ"
      End
      Begin VB.Menu mnuModify_ListPopup 
         Caption         =   "ÐÞ¸Ä"
      End
      Begin VB.Menu mnuDelete_ListPopup 
         Caption         =   "É¾³ý"
      End
      Begin VB.Menu mnuListPopupSep2 
         Caption         =   "-"
      End
      Begin VB.Menu mnuSpeakSelect_ListPopup 
         Caption         =   "¶ÁÑ¡¶¨µÄ´ÊÓï"
      End
   End
End
Attribute VB_Name = "Form1"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Dim WithEvents A As SpVoice
Attribute A.VB_VarHelpID = -1
Dim objVoices As ISpeechObjectTokens
Dim i As Integer
Dim intBBCS As Integer '²¥±¨´ÎÊý
Dim intYGMS As Integer 'ÒÑ¹ýÃëÊý
Dim ListPopupIndex As Integer
Dim EnglishVoiceGood As Boolean, ChineseVoiceGood As Boolean

Private Sub A_EndStream(ByVal StreamNumber As Long, ByVal StreamPosition As Variant)
Command1.Enabled = True
Command3.Enabled = True
If Zdbb = True Then Command7.Enabled = True
Command9.Enabled = True
mnuSpeakSelect_ListPopup.Enabled = True
intBBCS = intBBCS + 1
Label2.Caption = CStr(intBBCS)
If Zdbb = True Then
    If intBBCS >= Val(Text2.Text) And i < List1.ListCount Then
            intYGMS = 0
            Label5.Caption = Text1.Text
            Timer1.Enabled = True
                If Val(Text1.Text) = 0 Then
                Timer1_Timer
                End If
    ElseIf intBBCS < Val(Text2.Text) And i <= List1.ListCount Then
        intYGMS = 0
        Label5.Caption = Text1.Text
        Timer1.Enabled = True
            If Val(Text1.Text) = 0 Then
            Timer1_Timer
            End If
    Else
    Zdbb = False
    Command6.Enabled = True
    Command12.Enabled = False
    Command7.Enabled = False
    MsgBox "×Ô¶¯²¥±¨ÒÑÍê³É£¡"
    End If
End If
End Sub


Private Sub A_StartStream(ByVal StreamNumber As Long, ByVal StreamPosition As Variant)
Command1.Enabled = False
Command3.Enabled = False
Command7.Enabled = False
Command9.Enabled = False
mnuSpeakSelect_ListPopup.Enabled = False
Timer1.Enabled = False
Label5.Caption = "0"
End Sub




Private Sub cmdAdd_Click()
  Dim sTmp As String
  sTmp = InputBox("ÊäÈëÒªÌí¼ÓµÄÐÂÏîÄ¿£º")
  If Len(sTmp) = 0 Then Exit Sub
  List1.AddItem sTmp
  SetListButtons
End Sub



Private Sub cmdDelete_Click()
Dim Temp As Integer
Temp = List1.ListIndex
  If Temp > -1 Then
    If MsgBox("ÄúÕæµÄÒªÉ¾³ý¡°" & List1.List(Temp) & "¡±Âð£¿", vbQuestion + vbYesNo) = vbYes Then
      List1.RemoveItem Temp
      SetListButtons
    End If
  End If
End Sub



Private Sub cmdSave_Click()
CommonDialog1.FileName = ""
CommonDialog1.Flags = cdlOFNExplorer
CommonDialog1.ShowSave
If CommonDialog1.FileName <> "" Then
    Dim Temp As String
    Open CommonDialog1.FileName For Output As #1
        For i = 0 To List1.ListCount - 1
        Print #1, List1.List(i)
        Next
    Close #1
End If
End Sub



Private Sub Combo1_Click()
Set A.Voice = objVoices.Item(Combo1.ListIndex)
SaveSetting "×Ô¶¯Ä¬Ð´", "TTSÒýÇæ", "ÒýÇæ", Combo1.ListIndex
End Sub

Private Sub Command1_Click()
If List1.ListCount = 0 Then
MsgBox "ÇëÏÈÌí¼Ó´ÊÓï£¡", vbOKOnly, Me.Caption
Exit Sub
End If
If i >= List1.ListCount Then
MsgBox "ÒÑ¾­²¥ÍêÁË¡£"
Exit Sub
End If
intBBCS = 0
List1.ListIndex = i
If Len(DCZQML) = 0 Then
A.Speak List1.List(i), SVSFlagsAsync
Else
    Dim StreamFileName As String
    StreamFileName = List1.List(i)
    StreamFileName = Replace(StreamFileName, "\", "")
    StreamFileName = Replace(StreamFileName, "/", "")
    StreamFileName = Replace(StreamFileName, ":", "")
    StreamFileName = Replace(StreamFileName, "*", "")
    StreamFileName = Replace(StreamFileName, "?", "")
    StreamFileName = Replace(StreamFileName, Chr(34), "")
    StreamFileName = Replace(StreamFileName, "<", "")
    StreamFileName = Replace(StreamFileName, ">", "")
    StreamFileName = Replace(StreamFileName, "|", "")
    StreamFileName = DCZQML & StreamFileName & ".wav"
    If FSO.FileExists(StreamFileName) = True Then
        Dim FileStream As New SpFileStream
        Call FileStream.Open(StreamFileName)
        A.SpeakStream FileStream, SVSFlagsAsync
    Else
    A.Speak List1.List(i), SVSFlagsAsync
    End If
End If

i = i + 1
Label15.Caption = i
Label2.Caption = CStr(intBBCS)
End Sub

Private Sub cmdOpen_Click()
CommonDialog1.FileName = ""
CommonDialog1.Flags = cdlOFNExplorer Or cdlOFNAllowMultiselect
CommonDialog1.ShowOpen
If CommonDialog1.FileName <> "" Then
    If InStr(1, CommonDialog1.FileName, Chr(0)) > 0 Then
        Dim FilePath As String
        Dim FileNames() As String
        Dim x As Integer
        FilePath = Mid(CommonDialog1.FileName, 1, InStr(1, CommonDialog1.FileName, Chr(0)) - 1)
        If Right$(FilePath, 1) <> "\" Then FilePath = FilePath & "\"
        FileNames = Split(Mid(CommonDialog1.FileName, InStr(1, CommonDialog1.FileName, Chr(0)) + 1), Chr(0))
        For x = 0 To UBound(FileNames)
        OpenFile FilePath & FileNames(x)
        Next
    Else
        OpenFile CommonDialog1.FileName
End If
End If
End Sub

Private Sub cmdShowCount_Click()
MsgBox "´ÊÓïÊýÁ¿£º" & List1.ListCount
End Sub


Private Sub Command10_Click()
If Command10.Tag = "" Then
MsgBox "ÄúµÄµçÄÔÖÐÃ»ÓÐÖÐÎÄÔÄ¶ÁÒýÇæ¡£"
Exit Sub
ElseIf ChineseVoiceGood = False Then
    If MsgBox("ÔÚÄúµÄµçÄÔÖÐÃ»ÓÐ·¢ÏÖÖÊÁ¿½Ï¸ßµÄÖÐÎÄÔÄ¶ÁÒýÇæ£¬" & _
    "ÊÇ·ñÇÐ»»µ½ÖÊÁ¿½Ï²îµÄÖÐÎÄÔÄ¶ÁÒýÇæ£¿", vbYesNo) = vbNo Then
    Exit Sub
    End If
End If
Combo1.ListIndex = Val(Command10.Tag)
End Sub

Private Sub Command11_Click()
If Command11.Tag = "" Then
MsgBox "ÄúµÄµçÄÔÖÐÃ»ÓÐÓ¢ÎÄÔÄ¶ÁÒýÇæ¡£"
Exit Sub
ElseIf EnglishVoiceGood = False Then
    If MsgBox("ÔÚÄúµÄµçÄÔÖÐÃ»ÓÐ·¢ÏÖÖÊÁ¿½Ï¸ßµÄÓ¢ÎÄÔÄ¶ÁÒýÇæ£¬" & _
    "ÊÇ·ñÇÐ»»µ½ÖÊÁ¿½Ï²îµÄÓ¢ÎÄÔÄ¶ÁÒýÇæ£¿", vbYesNo) = vbNo Then
    Exit Sub
    End If
End If
Combo1.ListIndex = Val(Command11.Tag)
End Sub

Private Sub Command12_Click()
Zdbb = False
Command6.Enabled = True
Command7.Enabled = False
Command12.Enabled = False
Timer1.Enabled = False
Label5.Caption = "0"
If A.Status.RunningState <> SRSEDone Then
A.Speak vbNullString, SVSFPurgeBeforeSpeak
Command1.Enabled = True
Command3.Enabled = True
Command9.Enabled = True
mnuSpeakSelect_ListPopup.Enabled = True
End If
MsgBox "×Ô¶¯²¥±¨ÒÑ½áÊø£¡"
End Sub

Private Sub Command2_Click()
If Frame1.Visible Then
Frame1.Visible = False
Label16.Visible = True
Else
Frame1.Visible = True
Label16.Visible = False
End If
End Sub

Private Sub Command3_Click()
If (i <= List1.ListCount) And (i > 0) Then
List1.ListIndex = i - 1
    If Len(DCZQML) = 0 Then
    A.Speak List1.List(i - 1), SVSFlagsAsync
    Else
        Dim StreamFileName As String
        StreamFileName = List1.List(i - 1)
        StreamFileName = Replace(StreamFileName, "\", "")
        StreamFileName = Replace(StreamFileName, "/", "")
        StreamFileName = Replace(StreamFileName, ":", "")
        StreamFileName = Replace(StreamFileName, "*", "")
        StreamFileName = Replace(StreamFileName, "?", "")
        StreamFileName = Replace(StreamFileName, Chr(34), "")
        StreamFileName = Replace(StreamFileName, "<", "")
        StreamFileName = Replace(StreamFileName, ">", "")
        StreamFileName = Replace(StreamFileName, "|", "")
        StreamFileName = DCZQML & StreamFileName & ".wav"
        If FSO.FileExists(StreamFileName) = True Then
            Dim FileStream As New SpFileStream
            Call FileStream.Open(StreamFileName)
            A.SpeakStream FileStream, SVSFlagsAsync
        Else
        A.Speak List1.List(i - 1), SVSFlagsAsync
        End If
    End If
Else
MsgBox "»¹Ã»±¨¹ýÁË£¡"
End If
End Sub

Private Sub cmdClear_Click()
List1.Clear
SetListButtons
End Sub

Private Sub Command4_Click()
Dim Temp As Integer
Temp = List1.ListIndex
  If Temp > -1 Then
    Dim strNewText As String
    strNewText = InputBox("Äú×¼±¸½«¡°" & List1.List(Temp) & "¡±ÐÞ¸Ä³É£º", , List1.Text)
    If Len(strNewText) > 0 Then
      List1.List(Temp) = strNewText
      SetListButtons
    End If
  End If
End Sub

Private Sub Command5_Click()
i = 0
If List1.ListCount > 0 Then List1.ListIndex = 0
End Sub

Private Sub cmdUp_Click()
  On Error Resume Next
  Dim nItem As Integer
  
  With List1
    If .ListIndex < 0 Then Exit Sub
    nItem = .ListIndex
    If nItem = 0 Then Exit Sub  '²»ÄÜ½«µÚÒ»¸öÏîÄ¿ÏòÉÏÒÆ¶¯
    'ÏòÉÏÒÆ¶¯ÏîÄ¿
    .AddItem .Text, nItem - 1
    'É¾³ý¾ÉÏîÄ¿
    .RemoveItem nItem + 1
    'Ñ¡Ôñ¸Õ¸ÕÒÆ¶¯µÄÏîÄ¿
    .Selected(nItem - 1) = True
  End With
End Sub

Private Sub cmdDown_Click()
  On Error Resume Next
  Dim nItem As Integer
  
  With List1
    If .ListIndex < 0 Then Exit Sub
    nItem = .ListIndex
    If nItem = .ListCount - 1 Then Exit Sub '²»ÄÜ½«×îºóµÄÏîÄ¿ÏòÏÂÒÆ¶¯
    'ÏòÏÂÒÆ¶¯ÏîÄ¿
    .AddItem .Text, nItem + 2
    'É¾³ý¾ÉµÄÏîÄ¿
    .RemoveItem nItem
    'Ñ¡Ôñ¸Õ¸ÕÒÆ¶¯µÄÏîÄ¿
    .Selected(nItem + 1) = True
  End With
End Sub

Private Sub Command6_Click()
If List1.ListCount = 0 Then
MsgBox "ÇëÏÈÌí¼Ó´ÊÓï£¡", vbOKOnly, Me.Caption
Exit Sub
End If
Command6.Enabled = False
Command12.Enabled = True
Label5.Caption = Text1.Text
intYGMS = 0
Timer1.Enabled = True
Zdbb = True
i = 0
Command1_Click
End Sub

Private Sub Command7_Click()
Command7.Enabled = False
Timer1.Enabled = False
Command3.SetFocus
End Sub

Private Sub Command8_Click()
If List1.ListCount > 0 Then Form2.Show 1
End Sub

Private Sub Command9_Click()
If i <= List1.ListCount And i > 1 Then
i = i - 2
Command1_Click
Else
MsgBox "ÒÑ¾­ÊÇµÚ1¸öÁË£¡"
End If
End Sub

Private Sub Form_Load()
Label16.Caption = "´ÊÓïÁÐ±í" & vbNewLine & "ÒÑÒþ²Ø"
Dim EnglishGrade As Integer, ChineseGrade As Integer 'ÉùÃ÷ÓÃÓÚ¼ÇÂ¼ÓïÒôÒýÇæÖÊÁ¿µÈ¼¶µÄ±äÁ¿
Dim objVoice As SpObjectToken
Dim strVoiceLanguage As String
Dim strVoiceName As String
EnglishGrade = 0 '³õÊ¼»¯ÓÃÓÚ¼ÇÂ¼Ó¢ÎÄÓïÒôÒýÇæÖÊÁ¿µÈ¼¶µÄ±äÁ¿
ChineseGrade = 0 '³õÊ¼»¯ÓÃÓÚ¼ÇÂ¼ÖÐÎÄÓïÒôÒýÇæÖÊÁ¿µÈ¼¶µÄ±äÁ¿
Set A = New SpVoice '´´½¨SpVoice¶ÔÏóÊµÀý
Set objVoices = A.GetVoices '¶ÁÈ¡·¢ÒôÈËÎï¼¯ºÏ
    If objVoices.Count = 0 Then
    MsgBox "Î´·¢ÏÖTTSÓïÒôÒýÇæ", vbOKOnly, "Error"
    End
    End If
For i = 0 To objVoices.Count - 1 '±éÀú·¢ÒôÈËÎï¼¯ºÏ
Set objVoice = objVoices.Item(i) '¶ÁÈ¡·¢ÒôÈËÎï¼¯ºÏÖÐÏàÓ¦Ë÷ÒýµÄÓïÒô¶ÔÏó
strVoiceName = objVoice.GetDescription '¶ÁÈ¡·¢ÒôÈËÎïÃû³Æ
Combo1.AddItem strVoiceName 'ÔÚ×éºÏ¿òÖÐÌí¼Ó
    strVoiceLanguage = objVoice.GetAttribute("Language") '¶ÁÈ¡·¢ÒôÈËÎïÓïÑÔ
    If strVoiceLanguage = "409" Or strVoiceLanguage Like "*;409" Or strVoiceLanguage Like "409;*" Or strVoiceLanguage Like "*;409;*" Then 'µ±·¢ÒôÈËÎïÓïÑÔÎªÓ¢ÎÄÊ±
        If (EnglishGrade = 0) Or (EnglishGrade > GetEnglishGrade(strVoiceName) And GetEnglishGrade(strVoiceName) <> 0) Then
        Command11.Tag = i
        EnglishGrade = GetEnglishGrade(strVoiceName)
        End If
    ElseIf strVoiceLanguage = "804" Or strVoiceLanguage Like "*;804" Or strVoiceLanguage Like "804;*" Or strVoiceLanguage Like "*;804;*" Then 'µ±·¢ÒôÈËÎïÓïÑÔÎªÖÐÎÄÊ±
        If (ChineseGrade = 0) Or (ChineseGrade > GetChineseGrade(strVoiceName) And GetChineseGrade(strVoiceName) <> 0) Then
        Command10.Tag = i
        ChineseGrade = GetChineseGrade(strVoiceName)
        End If
    End If
Next
EnglishVoiceGood = EnglishGrade > 0 And EnglishGrade < 5
ChineseVoiceGood = ChineseGrade
Combo1.ListIndex = GetSetting("×Ô¶¯Ä¬Ð´", "TTSÒýÇæ", "ÒýÇæ", 0)
Slider1.Value = GetSetting("×Ô¶¯Ä¬Ð´", "TTSÒýÇæ", "ÓïËÙ", "0")
Slider2.Value = GetSetting("×Ô¶¯Ä¬Ð´", "TTSÒýÇæ", "ÒôÁ¿", "100")
i = 0
intBBCS = 0
'Ö§³ÖÎÄ¼þ¹ØÁª·½Ê½´ò¿ª£º
Dim FileName As String
FileName = Command '¶ÁÈ¡ÔËÐÐ²ÎÊý
If Len(FileName) > 0 Then 'ÔËÐÐ²ÎÊý²»µÈÓÚ¿ÕÊ±
    If Left$(FileName, 1) = Chr(34) Then 'µÚÒ»¸ö×Ö·ûµÈÓÚ¡°"¡±Ê±
    FileName = Mid(FileName, 2, Len(FileName) - 2) 'È¡µÚ2¸ö×Ö·ûµ½£¨×îºóÒ»¸ö×Ö·û-1£©µÄ×Ö·û´®
    End If
    If FSO.FileExists(FileName) = True Then '´æÔÚÕâ¸öÎÄ¼þÊ±
    OpenFile FileName '´ò¿ªÕâ¸öÎÄ¼þ
    End If
End If
DCZQML = GetSetting("×Ô¶¯Ä¬Ð´", "TTSÒýÇæ", "µ¥´ÊÔöÇ¿", "")
End Sub

Private Sub Form_Resize()
On Error Resume Next
If Me.Width < 8430 Then
Me.Width = 8430
End If
If Me.Height < 9480 Then
Me.Height = 9480
End If
Frame1.Width = Me.Width - 6150
Command2.Left = Frame1.Width + Frame1.Left + 105
Frame2.Left = Command2.Width + Command2.Left + 105
Frame3.Left = Command2.Width + Command2.Left + 105
Label10.Left = Command2.Width + Command2.Left + 105
List1.Width = Frame1.Width - 600
cmdOpen.Left = List1.Width + List1.Left
cmdSave.Left = List1.Width + List1.Left
cmdUp.Left = List1.Width + List1.Left
cmdDown.Left = List1.Width + List1.Left
cmdAdd.Left = List1.Width + List1.Left
Command4.Left = List1.Width + List1.Left
cmdDelete.Left = List1.Width + List1.Left
cmdClear.Left = List1.Width + List1.Left
cmdShowCount.Left = List1.Width + List1.Left
Command8.Left = List1.Width + List1.Left
Frame1.Height = Me.Height - 1065
List1.Height = Frame1.Height - 375
Label10.Top = Me.Height - 1440
Frame3.Top = Label10.Top - 105 - Frame3.Height
Frame2.Height = Me.Height - 3585 - Frame2.Top
Label3.Top = Frame2.Height - 615
Label5.Top = Frame2.Height - 615
Label4.Top = Frame2.Height - 615
Command2.Height = Frame1.Height
Dim Temp1 As Integer
Dim Temp2 As Integer
Temp1 = Frame2.Height - 3960
Temp2 = Screen.TwipsPerPixelY
Temp1 = Temp1 + Temp2 * 5
Temp1 = Temp1 / 5
Temp1 = Temp1 \ Temp2
Temp1 = Temp1 * Temp2
Command6.Height = Temp1
Command12.Height = Temp1
Command7.Top = Command12.Top + Temp1 - Temp2
Command7.Height = Temp1 + Temp1
Command1.Top = Command7.Top + Temp1 + Temp1 - Temp2
Command1.Height = Temp1
Command5.Top = Command7.Top + Temp1 + Temp1 - Temp2
Command5.Height = Temp1
Command9.Top = Command1.Top + Temp1 - Temp2
Command9.Height = Temp1
Command3.Top = Command1.Top + Temp1 - Temp2
Command3.Height = Temp1
Label16.Left = Frame1.Left + ((Frame1.Width - Label16.Width) / 2)
Label16.Top = Frame1.Top + ((Frame1.Height - Label16.Height) / 3)
End Sub





Private Sub List1_Click()
  SetListButtons
End Sub

Sub SetListButtons()
  Dim IntListIndex As Integer
  Dim IntListCount As Integer
  IntListIndex = List1.ListIndex
  IntListCount = List1.ListCount
  'ÉèÖÃÒÆ¶¯°´Å¥µÄ×´Ì¬
  cmdUp.Enabled = (IntListIndex > 0)
  cmdDown.Enabled = ((IntListIndex > -1) And (IntListIndex < (IntListCount - 1)))
  cmdDelete.Enabled = (IntListIndex > -1)
  cmdClear.Enabled = IntListCount
  Command8.Enabled = IntListCount
  Command4.Enabled = (IntListIndex > -1)
End Sub

Private Sub List1_MouseDown(Button As Integer, Shift As Integer, x As Single, Y As Single)
If Button = 2 Then
    Dim pos As Long, idx As Long
    pos = x / Screen.TwipsPerPixelX + Y / Screen.TwipsPerPixelY * 65536
    idx = SendMessage(List1.hWnd, LB_ITEMFROMPOINT, 0, ByVal pos)
    If idx < 65536 Then
    List1.ListIndex = idx
    ListPopupIndex = idx
    mnuName_ListPopup.Caption = "µ±Ç°Ñ¡Ôñ£º" & List1.List(ListPopupIndex) & "£¨µÚ" & ListPopupIndex + 1 & "Ìõ£©"
    PopupMenu mnuListPopup
    Else
    List1.ListIndex = -1
    End If
End If
End Sub

Private Sub List1_MouseMove(Button As Integer, Shift As Integer, x As Single, Y As Single)
    Dim pos As Long, idx As Long
    pos = x / Screen.TwipsPerPixelX + Y / Screen.TwipsPerPixelY * 65536
    idx = SendMessage(List1.hWnd, LB_ITEMFROMPOINT, 0, ByVal pos)
    If idx < 65536 Then
    List1.ToolTipText = List1.List(idx)
    Else
    List1.ToolTipText = ""
    End If
End Sub

Private Sub Menu2_Click()
Form3.Show 1
End Sub

Private Sub mnuAbout_Click()
frmAbout.Show 1
End Sub



Private Sub mnuAdd_Click()
If List1.Visible = False Then Exit Sub
cmdAdd_Click
End Sub

Private Sub mnuClear_Click()
If List1.Visible = False Then Exit Sub
cmdClear_Click
End Sub

Private Sub mnuDelete_Click()
If List1.Visible = False Then Exit Sub
cmdDelete_Click
End Sub

Private Sub mnuDelete_ListPopup_Click()
List1.ListIndex = ListPopupIndex
mnuDelete_Click
End Sub

Private Sub mnuDown_Click()
If List1.Visible = False Then Exit Sub
cmdDown_Click
End Sub

Private Sub mnuDown_ListPopup_Click()
List1.ListIndex = ListPopupIndex
mnuDown_Click
End Sub

Private Sub mnuExit_Click()
End
End Sub

Private Sub mnuModify_Click()
If List1.Visible = False Then Exit Sub
Command4_Click
End Sub

Private Sub mnuModify_ListPopup_Click()
List1.ListIndex = ListPopupIndex
mnuModify_Click
End Sub

Private Sub mnuOpen_Click()
If List1.Visible = False Then Exit Sub
Call cmdOpen_Click
End Sub

Private Sub mnuSave_Click()
If List1.Visible = False Then Exit Sub
Call cmdSave_Click
End Sub


Private Sub mnuSelected_Click()
Command8_Click
End Sub

Private Sub mnuSpeakSelect_ListPopup_Click()
List1.ListIndex = ListPopupIndex
If i - 1 = List1.ListIndex Then
Command3_Click
Else
i = List1.ListIndex
Command1_Click
End If
End Sub

Private Sub mnuShowWordControl_Click()
Command2_Click
End Sub

Private Sub mnuUp_Click()
If List1.Visible = False Then Exit Sub
cmdUp_Click
End Sub

Private Sub mnuUp_ListPopup_Click()
List1.ListIndex = ListPopupIndex
mnuUp_Click
End Sub

Private Sub Slider1_Change()
A.Rate = Slider1.Value
SaveSetting "×Ô¶¯Ä¬Ð´", "TTSÒýÇæ", "ÓïËÙ", Slider1.Value
End Sub


Private Sub Slider2_Change()
A.Volume = Slider2.Value
SaveSetting "×Ô¶¯Ä¬Ð´", "TTSÒýÇæ", "ÒôÁ¿", Slider2.Value
End Sub


Private Sub Text1_Change()
If Text1.Text = "" Then
Text1.Text = "0"
Text1.SelStart = 0
Text1.SelLength = 1
End If
End Sub

Private Sub Text1_KeyDown(KeyCode As Integer, Shift As Integer)
If KeyCode = vbKeyReturn Then
Text2.SelStart = 0
Text2.SelLength = Len(Text2.Text)
Text2.SetFocus
End If
End Sub

Private Sub Text1_KeyPress(KeyAscii As Integer)
If KeyAscii <> 8 And KeyAscii < 48 Or KeyAscii > 57 Then KeyAscii = 0
End Sub



Private Sub Text2_Change()
If Val(Text2.Text) = 0 Then
Text2.Text = "1"
Text2.SelStart = 0
Text2.SelLength = 1
End If
End Sub

Private Sub Text2_KeyDown(KeyCode As Integer, Shift As Integer)
If KeyCode = vbKeyReturn Then Call Command6_Click
End Sub

Private Sub Text2_KeyPress(KeyAscii As Integer)
If KeyAscii <> 8 And KeyAscii < 48 Or KeyAscii > 57 Then KeyAscii = 0
End Sub

Private Sub Timer1_Timer()
intYGMS = intYGMS + 1
If Val(Text1.Text) - intYGMS > 0 Then
Label5.Caption = CStr(Val(Text1.Text) - intYGMS)
Else
Label5.Caption = "0"
End If
If intYGMS >= Val(Text1.Text) Then
    If intBBCS >= Val(Text2.Text) Or i = 0 Then
        If i < List1.ListCount Then
        Command1_Click
        Else
        Zdbb = False
        Command6.Enabled = True
        Command12.Enabled = False
        Command7.Enabled = False
        Timer1.Enabled = False
        MsgBox "×Ô¶¯²¥±¨ÒÑÍê³É£¡"
        End If
    Else
        If i <= List1.ListCount Then
        Command3_Click
        Else
        Zdbb = False
        Command6.Enabled = True
        Command12.Enabled = False
        Command7.Enabled = False
        Timer1.Enabled = False
        MsgBox "×Ô¶¯²¥±¨ÒÑÍê³É£¡"
        End If
    End If
End If
End Sub



Private Function GetEnglishGrade(VoiceName As String) As Integer
Select Case VoiceName
Case "VW Julie"
GetEnglishGrade = 1
Case "VW Paul"
GetEnglishGrade = 2
Case "VW Kate"
GetEnglishGrade = 3
Case Else
GetEnglishGrade = 0
End Select
End Function

Private Function GetChineseGrade(VoiceName As String) As Integer
Select Case VoiceName
Case "VW Lily"
GetChineseGrade = 1
Case "VW Hui"
GetChineseGrade = 2
Case "VW Liang"
GetChineseGrade = 3
Case "VW Wang"
GetChineseGrade = 4
Case "Girl XiaoKun"
GetChineseGrade = 5
Case Else
GetChineseGrade = 0
End Select
End Function

Public Sub OpenFile(FileName As String)
    Dim Temp As String
    Open FileName For Input As #1
    While Not EOF(1)
        Line Input #1, Temp
        If Temp <> "" Then List1.AddItem Temp
    Wend
    Close #1
    SetListButtons
End Sub
